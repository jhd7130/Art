<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="Admin">

	<select id="getMList" resultType="hashmap" parameterType="hashmap">
		SELECT * 
		FROM (  SELECT ROW_NUMBER() OVER (ORDER BY USER_NO DESC) AS RNUM, 
		        USER_NO, USER_ID, USER_NICKNAME, PW, NAME,
		        SEX,TO_CHAR(BIRTHDAY) AS BIRTHDAY, PHONE_NO,MAIL,TO_CHAR(JOIN_DATE) AS JOIN_DATE,
		        TRUNC(MONTHS_BETWEEN(TRUNC(SYSDATE),BIRTHDAY) / 12) as old
		        FROM USERS
		        WHERE 1=1)
		WHERE RNUM BETWEEN 1 AND ${endCnt}
	</select>

	<select id="getTCnt" resultType="Integer" parameterType="hashmap">
		SELECT COUNT(*)AS CNT
		FROM USERS
		WHERE 1=1
	</select>
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	
	<select id="PList" parameterType="hashmap" resultType="hashmap">
		SELECT P.POST_NO, PC.CATEGORY_NAME, P.TITLE, U.USER_NICKNAME AS NICKNAME,
				U.NAME, U.USER_ID, TO_CHAR(P.REGISTER_DATE, 'YY-MM-DD') AS R_DATE,
				P.VIEWS, DECODE(L.CNT, NULL, 0, L.CNT) AS CNT
		FROM ((POST P LEFT OUTER JOIN USERS U
		           				 ON P.USER_NO = U.USER_NO)
		    LEFT OUTER JOIN POST_CATEGORY PC
		        	   ON P.CATEGORY_NO = PC.CATEGORY_NO)
		    LEFT OUTER JOIN (SELECT P.POST_NO, COUNT(L.POST_NO) AS CNT
		                	FROM POST_LIKE L LEFT OUTER JOIN POST P
		          										 ON L.POST_NO = P.POST_NO 
		               									 GROUP BY P.POST_NO) L
		         		  ON P.POST_NO = L.POST_NO
		WHERE P.DEL = 1 AND P.VISIBILITY = 0
		ORDER BY P.POST_NO DESC
	</select>








</mapper>